var BeadApp=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function o(){return Object.create(null)}function s(t){t.forEach(n)}function i(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function r(t){let e;return l(t,(t=>e=t))(),e}function u(t,e,n){t.$$.on_destroy.push(l(e,n))}function a(t,n,o,s){return t[1]&&s?e(o.ctx.slice(),t[1](s(n))):o.ctx}function d(t,e,n=e){return t.set(n),e}function f(t,e){t.appendChild(e)}function p(t,e,n){t.insertBefore(e,n||null)}function h(t){t.parentNode.removeChild(t)}function v(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function b(t){return document.createElement(t)}function y(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function g(t){return document.createTextNode(t)}function m(){return g(" ")}function w(){return g("")}function x(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function k(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function q(t,e){for(const n in e)k(t,n,e[n])}function z(t){return""===t?null:+t}function M(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function T(t,e){t.value=null==e?"":e}function S(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}function j(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.t===e)return void(o.selected=!0)}}function R(t,e,n){t.classList[n?"add":"remove"](e)}let $;function A(t){$=t}const I=[],O=[],B=[],P=[],_=Promise.resolve();let C=!1;function U(t){B.push(t)}function F(t){P.push(t)}let N=!1;const L=new Set;function V(){if(!N){N=!0;do{for(let t=0;t<I.length;t+=1){const e=I[t];A(e),Z(e.$$)}for(A(null),I.length=0;O.length;)O.pop()();for(let t=0;t<B.length;t+=1){const e=B[t];L.has(e)||(L.add(e),e())}B.length=0}while(I.length);for(;P.length;)P.pop()();C=!1,N=!1,L.clear()}}function Z(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(U)}}const E=new Set;let G;function H(){G={r:0,c:[],p:G}}function D(){G.r||s(G.c),G=G.p}function J(t,e){t&&t.i&&(E.delete(t),t.i(e))}function K(t,e,n,o){if(t&&t.o){if(E.has(t))return;E.add(t),G.c.push((()=>{E.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function Q(t,e){t.d(1),e.delete(t.key)}function W(t,e){K(t,1,1,(()=>{e.delete(t.key)}))}function X(t,e,n,o,s,i,c,l,r,u,a,d){let f=t.length,p=i.length,h=f;const v={};for(;h--;)v[t[h].key]=h;const b=[],y=new Map,g=new Map;for(h=p;h--;){const t=d(s,i,h),l=n(t);let r=c.get(l);r?o&&r.p(t,e):(r=u(l,t),r.c()),y.set(l,b[h]=r),l in v&&g.set(l,Math.abs(h-v[l]))}const m=new Set,w=new Set;function x(t){J(t,1),t.m(l,a),c.set(t.key,t),a=t.first,p--}for(;f&&p;){const e=b[p-1],n=t[f-1],o=e.key,s=n.key;e===n?(a=e.first,f--,p--):y.has(s)?!c.has(o)||m.has(o)?x(e):w.has(s)?f--:g.get(o)>g.get(s)?(w.add(o),x(e)):(m.add(s),f--):(r(n,c),f--)}for(;f--;){const e=t[f];y.has(e.key)||r(e,c)}for(;p;)x(b[p-1]);return b}function Y(t,e){const n={},o={},s={$$scope:1};let i=t.length;for(;i--;){const c=t[i],l=e[i];if(l){for(const t in c)t in l||(o[t]=1);for(const t in l)s[t]||(n[t]=l[t],s[t]=1);t[i]=l}else for(const t in c)s[t]=1}for(const t in o)t in n||(n[t]=void 0);return n}function tt(t){return"object"==typeof t&&null!==t?t:{}}function et(t,e,n){const o=t.$$.props[e];void 0!==o&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function nt(t){t&&t.c()}function ot(t,e,o){const{fragment:c,on_mount:l,on_destroy:r,after_update:u}=t.$$;c&&c.m(e,o),U((()=>{const e=l.map(n).filter(i);r?r.push(...e):s(e),t.$$.on_mount=[]})),u.forEach(U)}function st(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function it(e,n,i,c,l,r,u=[-1]){const a=$;A(e);const d=n.props||{},f=e.$$={fragment:null,ctx:null,props:r,update:t,not_equal:l,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:o(),dirty:u,skip_bound:!1};let p=!1;if(f.ctx=i?i(e,d,((t,n,...o)=>{const s=o.length?o[0]:n;return f.ctx&&l(f.ctx[t],f.ctx[t]=s)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](s),p&&function(t,e){-1===t.$$.dirty[0]&&(I.push(t),C||(C=!0,_.then(V)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],f.update(),p=!0,s(f.before_update),f.fragment=!!c&&c(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(h)}else f.fragment&&f.fragment.c();n.intro&&J(e.$$.fragment),ot(e,n.target,n.anchor),V()}A(a)}class ct{$destroy(){st(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function lt(e){let n;return{c(){n=b("div"),n.innerHTML='<div class="title svelte-g6crc9"><span class="letter-b svelte-g6crc9">B</span> \n    <span class="letter-e svelte-g6crc9">e</span> \n    <span class="letter-a svelte-g6crc9">a</span> \n    <span class="letter-d svelte-g6crc9">d</span> \n    <span class="letter-s svelte-g6crc9">s</span></div>',k(n,"class","cell svelte-g6crc9")},m(t,e){p(t,n,e)},p:t,i:t,o:t,d(t){t&&h(n)}}}class rt extends ct{constructor(t){super(),it(this,t,null,lt,c,{})}}const ut=[];function at(e,n=t){let o;const s=[];function i(t){if(c(e,t)&&(e=t,o)){const t=!ut.length;for(let t=0;t<s.length;t+=1){const n=s[t];n[1](),ut.push(n,e)}if(t){for(let t=0;t<ut.length;t+=2)ut[t][0](ut[t+1]);ut.length=0}}}return{set:i,update:function(t){i(t(e))},subscribe:function(c,l=t){const r=[c,l];return s.push(r),1===s.length&&(o=n(i)||t),c(e),()=>{const t=s.indexOf(r);-1!==t&&s.splice(t,1),0===s.length&&(o(),o=null)}}}}const dt=["▲","▼","♥","♦","■","●","★","◆","▲","▼","◄","►","◊","○","□","△","▽","◈","◉","◐","◑","◒","◓","◔","◕","◖","◗","◘","◙","◚","◛","◜","◝","◞","◟","◠","◡","◢","◣","◤","◥","◦","◧","◨","◩","◪","◫","◬","◭","◮","◯"],ft="paint",pt="painting";function ht(t,e={}){const{subscribe:n,set:o,update:s}=at(t);return{subscribe:n,set:o,update:s,reset:()=>o("function"==typeof t?t():t),...e}}function vt(t=!1){const{subscribe:e,set:n,update:o}=at(t);return{subscribe:e,set:n,update:o,toggle:()=>o((t=>!t)),reset:()=>n(t)}}function bt(t={x:0,y:0}){const{subscribe:e,set:n,update:o}=at(t);return{subscribe:e,set:n,update:o,move:(t,e)=>o((n=>({x:n.x+t,y:n.y+e}))),reset:()=>n(t)}}function yt(t,e,n=!1){const o={...t};if(n){for(const t in e.added)delete o[t];for(const[t,n]of Object.entries(e.modified))o[t]=n.old;for(const{id:t,color:n}of e.removed)o[t]=n}else{Object.assign(o,e.added);for(const[t,n]of Object.entries(e.modified))o[t]=n.new;for(const{id:t}of e.removed)delete o[t]}return o}const gt=ht(0),mt=vt(!1),wt=vt(!0),xt=vt(!1),kt=ht(1,{zoomIn:function(){this.update((t=>Math.min(1.2*t,5)))},zoomOut:function(){this.update((t=>Math.max(t/1.2,.2)))},set:function(t){this.update((()=>Math.max(.2,Math.min(t,5))))}}),qt=bt(),zt=vt(!1),Mt=vt(!0),Tt=ht(ft,{setPaint:function(){this.set(ft)},setEraser:function(){this.set("eraser")},setSelection:function(){this.set("selection")},setGrid:function(){this.set("grid")}}),St=function(t=new Set){const{subscribe:e,set:n,update:o}=at(t);return{subscribe:e,set:n,update:o,add:t=>o((e=>new Set([...e,t]))),remove:t=>o((e=>{const n=new Set(e);return n.delete(t),n})),clear:()=>n(new Set),reset:()=>n(new Set)}}(),jt=bt(),Rt=vt(!1),$t=ht(3),At=ht({}),It=ht(0),Ot=ht({}),Bt=ht([{h:175,s:65,l:35,id:0},{h:150,s:74,l:72,id:1},{h:50,s:91,l:70,id:2},{h:11,s:100,l:85,id:3},{h:16,s:95,l:65,id:4},{h:0,s:100,l:100,id:5},{h:0,s:100,l:100,id:6},{h:0,s:100,l:100,id:7},{h:0,s:100,l:100,id:8},{h:0,s:100,l:100,id:9},{h:0,s:100,l:100,id:10},{h:0,s:100,l:100,id:11}].map(((t,e)=>({...t,symbol:dt[e]})))),Pt=ht(pt,{setPainting:function(){this.set(pt)},setConfiguring:function(){this.set("configuring")}}),_t=function(t={}){const e=at({baseState:t,deltas:[],cursor:0,canUndo:!1,canRedo:!1});let n=t;return{subscribe:e.subscribe,commit:t=>{e.update((e=>{const o=function(t,e){const n={added:{},modified:{},removed:[]};for(const[o,s]of Object.entries(e))o in t?t[o]!==s&&(n.modified[o]={old:t[o],new:s}):n.added[o]=s;for(const o in t)o in e||n.removed.push({id:o,color:t[o]});return n}(n,t);if(!(Object.keys(o.added).length>0||Object.keys(o.modified).length>0||o.removed.length>0))return e;const s=e.deltas.slice(0,e.cursor);if(s.push(o),n=t,s.length>100){const t=Math.floor(50);let n=e.baseState;for(let e=0;e<t;e++)n=yt(n,s[e]);return{baseState:n,deltas:s.slice(t),cursor:s.length-t,canUndo:s.length-t>0,canRedo:!1}}return{...e,deltas:s,cursor:s.length,canUndo:s.length>0,canRedo:!1}}))},undo:()=>{const t=r(e);return t.cursor>0?(n=yt(n,t.deltas[t.cursor-1],!0),e.update((t=>({...t,cursor:t.cursor-1,canUndo:t.cursor-1>0,canRedo:!0}))),n):n},redo:()=>{const t=r(e);return t.cursor<t.deltas.length?(n=yt(n,t.deltas[t.cursor]),e.update((t=>({...t,cursor:t.cursor+1,canUndo:!0,canRedo:t.cursor+1<t.deltas.length}))),n):n},getCurrentState:()=>{const t=r(e);let o=t.baseState;for(let e=0;e<t.cursor;e++)o=yt(o,t.deltas[e]);return n=o,o},reset:()=>{const t={};e.set({baseState:t,deltas:[],cursor:0,canUndo:!1,canRedo:!1}),n=t},get canUndo(){return r(e).canUndo},get canRedo(){return r(e).canRedo}}}({}),Ct=function(e,n,o){const c=!Array.isArray(e),r=c?[e]:e,u=n.length<2;return{subscribe:at(void 0,(e=>{let o=!1;const a=[];let d=0,f=t;const p=()=>{if(d)return;f();const o=n(c?a[0]:a);u?e(o):f=i(o)?o:t},h=r.map(((t,e)=>l(t,(t=>{a[e]=t,d&=~(1<<e),o&&p()}),(()=>{d|=1<<e}))));return o=!0,p(),function(){s(h),f()}})).subscribe}}([Ot,At,Bt],(([t,e,n])=>{const o={};return Object.values(t).forEach((t=>{void 0!==t&&(o[t]=(o[t]||0)+1)})),Object.values(e).forEach((t=>{void 0!==t&&(o[t]=(o[t]||0)+1)})),Object.entries(o).map((([t,e])=>{const o=n[parseInt(t)];return{id:t,color:o,symbol:o.symbol,count:e}})).sort(((t,e)=>parseInt(t.id)-parseInt(e.id)))}));function Ut(t,e,n){return{row:Math.floor(t/n),col:t%n}}function Ft(t,e,n){return t>=0&&t<n&&e>=0&&e<n?t*n+e:null}function Nt(e){let n,o,i,c,l,r,u,a,d,v,y,g,w,q;return{c(){n=b("div"),o=b("div"),i=b("button"),i.textContent="↑",c=m(),l=b("div"),r=b("button"),r.textContent="←",u=m(),a=b("button"),a.textContent="→",d=m(),v=b("button"),v.textContent="↓",y=m(),g=b("button"),g.textContent="✓",k(i,"class","move-button svelte-15xublr"),k(i,"aria-label","move up"),k(r,"class","move-button svelte-15xublr"),k(r,"aria-label","move left"),k(a,"class","move-button svelte-15xublr"),k(a,"aria-label","move right"),k(l,"class","move-row svelte-15xublr"),k(v,"class","move-button svelte-15xublr"),k(v,"aria-label","move down"),k(o,"class","move-arrows svelte-15xublr"),k(g,"class","confirm-button svelte-15xublr"),k(g,"aria-label","confirm move"),k(n,"class","move-controls svelte-15xublr")},m(t,s){p(t,n,s),f(n,o),f(o,i),f(o,c),f(o,l),f(l,r),f(l,u),f(l,a),f(o,d),f(o,v),f(n,y),f(n,g),w||(q=[x(i,"click",e[6]),x(r,"click",e[7]),x(a,"click",e[8]),x(v,"click",e[9]),x(g,"click",e[2])],w=!0)},p:t,d(t){t&&h(n),w=!1,s(q)}}}function Lt(e){let n,o=e[0].size>0&&Nt(e);return{c(){o&&o.c(),n=w()},m(t,e){o&&o.m(t,e),p(t,n,e)},p(t,[e]){t[0].size>0?o?o.p(t,e):(o=Nt(t),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:t,o:t,d(t){o&&o.d(t),t&&h(n)}}}function Vt(t,e,n){let o,s,i;u(t,St,(t=>n(0,o=t))),u(t,jt,(t=>n(10,s=t))),u(t,Ot,(t=>n(11,i=t)));let{gridSize:c}=e,{stitchType:l}=e,{layoutRotation:r}=e;const a=(t,e)=>{o.size>0&&jt.move(t,e)};return t.$$set=t=>{"gridSize"in t&&n(3,c=t.gridSize),"stitchType"in t&&n(4,l=t.stitchType),"layoutRotation"in t&&n(5,r=t.layoutRotation)},[o,a,()=>{if(o.size>0&&(0!==s.x||0!==s.y)){const t=function(t,e,n,o,s,i){if(0===t.size||0===e.x&&0===e.y)return n;const c={...n},l=Array.from(t),r=new Map;return l.forEach((t=>{const o=n[t];if(void 0!==o){const n=Ut(t,0,s),i=Ft(n.row+e.y,n.col+e.x,s);null!==i&&r.set(t,{newBeadId:i,colorId:o})}})),l.forEach((t=>{delete c[t]})),r.forEach((({newBeadId:t,colorId:e})=>{c[t]=e})),c}(o,s,i,0,c);Ot.set(t),_t.commit(t),St.clear(),jt.reset()}},c,l,r,()=>a(0,-1),()=>a(-1,0),()=>a(1,0),()=>a(0,1)]}class Zt extends ct{constructor(t){super(),it(this,t,Vt,Lt,c,{gridSize:3,stitchType:4,layoutRotation:5})}}function Et(e){let n,o,s,i;return{c(){n=b("div"),o=b("button"),o.textContent="🗑️",k(o,"class","reset-button svelte-dyjwk4"),k(o,"aria-label","reset canvas"),k(o,"title","Reset canvas (clear all work)"),k(n,"class","reset-control svelte-dyjwk4")},m(t,c){p(t,n,c),f(n,o),s||(i=x(o,"click",e[0]),s=!0)},p:t,i:t,o:t,d(t){t&&h(n),s=!1,i()}}}function Gt(t){return[()=>{confirm("Are you sure you want to reset the canvas? This will clear all your work.")&&(Ot.reset(),_t.reset(),St.clear(),jt.reset(),Tt.reset())}]}class Ht extends ct{constructor(t){super(),it(this,t,Gt,Et,c,{})}}function Dt(t){let e,n,o,s,i,c,l,r,u;return{c(){e=b("div"),n=b("h4"),n.textContent="Fringe Controls",o=m(),s=b("div"),i=b("label"),c=g("Length (1-20 beads):\r\n        "),l=b("input"),k(n,"class","svelte-b96hy4"),k(l,"type","number"),k(l,"min","1"),k(l,"max","20"),l.value=t[1],k(l,"class","svelte-b96hy4"),k(i,"class","svelte-b96hy4"),k(s,"class","fringe-config svelte-b96hy4"),k(e,"class","fringe-controls svelte-b96hy4")},m(a,d){p(a,e,d),f(e,n),f(e,o),f(e,s),f(s,i),f(i,c),f(i,l),r||(u=x(l,"input",t[4]),r=!0)},p(t,e){2&e&&(l.value=t[1])},d(t){t&&h(e),r=!1,u()}}}function Jt(e){let n,o=e[0]&&Dt(e);return{c(){o&&o.c(),n=w()},m(t,e){o&&o.m(t,e),p(t,n,e)},p(t,[e]){t[0]?o?o.p(t,e):(o=Dt(t),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:t,o:t,d(t){o&&o.d(t),t&&h(n)}}}function Kt(t,e,n){let o;u(t,$t,(t=>n(1,o=t)));let{stitchType:s}=e;const i=t=>{$t.set(Math.max(1,Math.min(20,t)))};let c;return t.$$set=t=>{"stitchType"in t&&n(3,s=t.stitchType)},t.$$.update=()=>{8&t.$$.dirty&&n(0,c="brick"===s)},[c,o,i,s,t=>i(parseInt(t.target.value)||1)]}class Qt extends ct{constructor(t){super(),it(this,t,Kt,Jt,c,{stitchType:3})}}function Wt(t,e,n){const o=t.slice();return o[29]=e[n],o}function Xt(t,e,n){const o=t.slice();return o[29]=e[n],o}function Yt(t,e,n){const o=t.slice();return o[34]=e[n],o}function te(e){let n,o,s;return{c(){n=b("button"),n.innerHTML='<span class="rotate-symbol svelte-1pce8uq">↻</span>',k(n,"class","rotate-button svelte-1pce8uq"),k(n,"aria-label","rotate")},m(t,i){p(t,n,i),o||(s=x(n,"click",e[13]),o=!0)},p:t,d(t){t&&h(n),o=!1,s()}}}function ee(t,e){let n,o,s;return{key:t,first:null,c(){n=b("div"),k(n,"class","color svelte-1pce8uq"),S(n,"--h",e[34].h),S(n,"--s",e[34].s+"%"),S(n,"--l",e[34].l+"%"),R(n,"selected",e[34].id==e[4]&&!e[8]),R(n,"blank",100==e[34].l),R(n,"disabled",e[8]),this.first=n},m(t,c){p(t,n,c),o||(s=x(n,"click",(function(){i(e[14](e[34].id))&&e[14](e[34].id).apply(this,arguments)})),o=!0)},p(t,o){e=t,8&o[0]&&S(n,"--h",e[34].h),8&o[0]&&S(n,"--s",e[34].s+"%"),8&o[0]&&S(n,"--l",e[34].l+"%"),280&o[0]&&R(n,"selected",e[34].id==e[4]&&!e[8]),8&o[0]&&R(n,"blank",100==e[34].l),256&o[0]&&R(n,"disabled",e[8])},d(t){t&&h(n),o=!1,s()}}}function ne(t){let e,n,o,s,i,c,l,r,u,a,d,v=t[29].icon+"",y=t[29].label+"";function w(){return t[27](t[29])}return{c(){e=b("button"),n=b("span"),o=g(v),s=m(),i=b("span"),c=g(y),l=m(),k(n,"class","tool-icon svelte-1pce8uq"),k(i,"class","tool-label svelte-1pce8uq"),k(e,"class","tool-button primary svelte-1pce8uq"),k(e,"aria-label",r=t[29].label),k(e,"title",u=t[29].description),S(e,"--tool-color",t[29].color),R(e,"active",t[12]===t[29].id)},m(t,r){p(t,e,r),f(e,n),f(n,o),f(e,s),f(e,i),f(i,c),f(e,l),a||(d=x(e,"click",w),a=!0)},p(n,o){t=n,528384&o[0]&&R(e,"active",t[12]===t[29].id)},d(t){t&&h(e),a=!1,d()}}}function oe(t){let e,n,o,s,i,c,l,r,u,a,d,v=t[29].icon+"",y=t[29].label+"";function w(){return t[28](t[29])}return{c(){e=b("button"),n=b("span"),o=g(v),s=m(),i=b("span"),c=g(y),l=m(),k(n,"class","tool-icon svelte-1pce8uq"),k(i,"class","tool-label svelte-1pce8uq"),k(e,"class","tool-button view svelte-1pce8uq"),k(e,"aria-label",r=t[29].label),k(e,"title",u=t[29].description),S(e,"--tool-color",t[29].color),R(e,"active",t[29].active)},m(t,r){p(t,e,r),f(e,n),f(n,o),f(e,s),f(e,i),f(i,c),f(e,l),a||(d=x(e,"click",w),a=!0)},p(n,s){t=n,2048&s[0]&&v!==(v=t[29].icon+"")&&M(o,v),2048&s[0]&&y!==(y=t[29].label+"")&&M(c,y),2048&s[0]&&r!==(r=t[29].label)&&k(e,"aria-label",r),2048&s[0]&&u!==(u=t[29].description)&&k(e,"title",u),2048&s[0]&&S(e,"--tool-color",t[29].color),2048&s[0]&&R(e,"active",t[29].active)},d(t){t&&h(e),a=!1,d()}}}function se(t){let e,n;return e=new Zt({props:{gridSize:t[1],stitchType:t[0],layoutRotation:t[2]}}),{c(){nt(e.$$.fragment)},m(t,o){ot(e,t,o),n=!0},p(t,n){const o={};2&n[0]&&(o.gridSize=t[1]),1&n[0]&&(o.stitchType=t[0]),4&n[0]&&(o.layoutRotation=t[2]),e.$set(o)},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){K(e.$$.fragment,t),n=!1},d(t){st(e,t)}}}function ie(t){let e,n;return e=new Qt({props:{stitchType:t[0]}}),{c(){nt(e.$$.fragment)},m(t,o){ot(e,t,o),n=!0},p(t,n){const o={};1&n[0]&&(o.stitchType=t[0]),e.$set(o)},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){K(e.$$.fragment,t),n=!1},d(t){st(e,t)}}}function ce(t){let e,n,o,i,c,l,r,u,a,d,y,w,q,z,$,A,I,O,B,P,_,C,F,N,L,V,Z,E,G,W,Y,tt,et,it,ct,lt,rt,ut,at,dt,ft,pt,ht,vt,bt,yt,gt,mt,wt,xt,kt,qt,zt,Mt,Tt,St,jt,Rt,$t,At,It,Ot,Bt,Pt,_t,Ct,Ut,Ft,Nt,Lt,Vt,Zt,Et,Gt,Dt,Jt,Kt,Qt,ce,le,re,ue,ae=[],de=new Map,fe=t[6]&&te(t),pe=t[3];const he=t=>t[34].id;for(let e=0;e<pe.length;e+=1){let n=Yt(t,pe,e),o=he(n);de.set(o,ae[e]=ee(o,n))}let ve=t[19],be=[];for(let e=0;e<ve.length;e+=1)be[e]=ne(Xt(t,ve,e));let ye=t[11],ge=[];for(let e=0;e<ye.length;e+=1)ge[e]=oe(Wt(t,ye,e));let me="selection"===t[12]&&se(t),we=t[5]&&"brick"===t[0]&&ie(t);return ce=new Ht({}),{c(){e=b("div"),n=b("section"),o=b("h3"),o.textContent="Canvas Size",i=m(),c=b("div"),l=b("div"),r=b("span"),u=g(t[1]),a=g(" × "),d=g(t[1]),y=m(),w=b("div"),q=b("input"),z=m(),$=b("div"),$.innerHTML='<span class="min-size">5×5</span> \n          <span class="max-size">50×50</span>',A=m(),I=b("section"),O=b("h3"),O.textContent="Stitch Type",B=m(),P=b("div"),_=b("select"),C=b("option"),C.textContent="Peyote Stitch (Vertical)",F=b("option"),F.textContent="Brick Stitch (Horizontal)",N=b("option"),N.textContent="Square Stitch",L=m(),fe&&fe.c(),V=m(),Z=b("section"),E=b("h3"),E.textContent="Colors",G=m(),W=b("div"),Y=b("div"),tt=b("div"),et=b("label"),et.textContent="Hue",it=m(),ct=b("input"),lt=m(),rt=b("div"),ut=b("label"),ut.textContent="Saturation",at=m(),dt=b("input"),ft=m(),pt=b("div"),ht=b("label"),ht.textContent="Lightness",vt=m(),bt=b("input"),yt=m(),gt=b("div");for(let t=0;t<ae.length;t+=1)ae[t].c();mt=m(),wt=b("section"),xt=b("h3"),xt.textContent="Tools",kt=m(),qt=b("div");for(let t=0;t<be.length;t+=1)be[t].c();zt=m(),Mt=b("section"),Tt=b("h3"),Tt.textContent="View",St=m(),jt=b("div");for(let t=0;t<ge.length;t+=1)ge[t].c();Rt=m(),$t=b("section"),me&&me.c(),At=m(),we&&we.c(),It=m(),Ot=b("section"),Bt=b("h3"),Bt.textContent="Actions",Pt=m(),_t=b("div"),Ct=b("div"),Ut=b("button"),Ft=g("↶"),Vt=m(),Zt=b("button"),Et=g("↷"),Jt=m(),Kt=b("button"),Kt.textContent="⌂",Qt=m(),nt(ce.$$.fragment),k(o,"class","section-title svelte-1pce8uq"),k(r,"class","size-label svelte-1pce8uq"),k(l,"class","size-display svelte-1pce8uq"),k(q,"type","range"),k(q,"min","5"),k(q,"max","50"),k(q,"step","1"),k(q,"class","canvas-size-slider svelte-1pce8uq"),k(q,"aria-label","Canvas size"),k($,"class","size-labels svelte-1pce8uq"),k(w,"class","size-slider svelte-1pce8uq"),k(c,"class","canvas-controls svelte-1pce8uq"),k(n,"class","tool-section canvas-config svelte-1pce8uq"),k(O,"class","section-title svelte-1pce8uq"),C.t="peyote",C.value=C.t,F.t="brick",F.value=F.t,N.t="square",N.value=N.t,k(_,"id","stitch-type"),k(_,"class","stitch-selector svelte-1pce8uq"),void 0===t[0]&&U((()=>t[23].call(_))),k(P,"class","stitch-controls svelte-1pce8uq"),k(I,"class","tool-section stitch-config svelte-1pce8uq"),k(E,"class","section-title svelte-1pce8uq"),k(et,"for","hue-slider"),k(et,"class","svelte-1pce8uq"),k(ct,"id","hue-slider"),k(ct,"type","range"),k(ct,"class","hue-gradient svelte-1pce8uq"),k(ct,"min","0"),k(ct,"max","360"),k(ct,"step","1"),k(tt,"class","slider-group svelte-1pce8uq"),k(ut,"for","sat-slider"),k(ut,"class","svelte-1pce8uq"),k(dt,"id","sat-slider"),k(dt,"type","range"),k(dt,"class","sat-gradient svelte-1pce8uq"),S(dt,"--h",t[7].h),S(dt,"--l",t[7].l+"%"),k(dt,"min","0"),k(dt,"max","100"),k(dt,"step","1"),k(rt,"class","slider-group svelte-1pce8uq"),k(ht,"for","light-slider"),k(ht,"class","svelte-1pce8uq"),k(bt,"id","light-slider"),k(bt,"type","range"),k(bt,"class","light-gradient svelte-1pce8uq"),S(bt,"--h",t[7].h),S(bt,"--s",t[7].s+"%"),k(bt,"min","0"),k(bt,"max","100"),k(bt,"step","1"),k(pt,"class","slider-group svelte-1pce8uq"),k(Y,"class","color-sliders svelte-1pce8uq"),k(gt,"class","colors-grid svelte-1pce8uq"),k(W,"class","color-palette svelte-1pce8uq"),k(Z,"class","tool-section color-controls svelte-1pce8uq"),k(xt,"class","section-title svelte-1pce8uq"),k(qt,"class","tool-grid svelte-1pce8uq"),k(wt,"class","tool-section primary-tools svelte-1pce8uq"),k(Tt,"class","section-title svelte-1pce8uq"),k(jt,"class","tool-grid svelte-1pce8uq"),k(Mt,"class","tool-section view-controls svelte-1pce8uq"),k($t,"class","tool-section contextual-controls svelte-1pce8uq"),k(Bt,"class","section-title svelte-1pce8uq"),k(Ut,"class","undo-redo-button svelte-1pce8uq"),Ut.disabled=Nt=!t[9],k(Ut,"aria-label",Lt=t[9]?"undo":"undo (disabled)"),k(Ut,"title","Undo last action"),R(Ut,"disabled",!t[9]),k(Zt,"class","undo-redo-button svelte-1pce8uq"),Zt.disabled=Gt=!t[10],k(Zt,"aria-label",Dt=t[10]?"redo":"redo (disabled)"),k(Zt,"title","Redo last action"),R(Zt,"disabled",!t[10]),k(Kt,"class","reset-view-button svelte-1pce8uq"),k(Kt,"aria-label","reset view"),k(Kt,"title","Reset zoom and pan to default"),k(Ct,"class","undo-redo-controls svelte-1pce8uq"),k(_t,"class","action-controls svelte-1pce8uq"),k(Ot,"class","tool-section undo-redo-actions svelte-1pce8uq"),k(e,"class","toolbox svelte-1pce8uq")},m(s,h){p(s,e,h),f(e,n),f(n,o),f(n,i),f(n,c),f(c,l),f(l,r),f(r,u),f(r,a),f(r,d),f(c,y),f(c,w),f(w,q),T(q,t[1]),f(w,z),f(w,$),f(e,A),f(e,I),f(I,O),f(I,B),f(I,P),f(P,_),f(_,C),f(_,F),f(_,N),j(_,t[0]),f(P,L),fe&&fe.m(P,null),f(e,V),f(e,Z),f(Z,E),f(Z,G),f(Z,W),f(W,Y),f(Y,tt),f(tt,et),f(tt,it),f(tt,ct),T(ct,t[3][t[4]].h),f(Y,lt),f(Y,rt),f(rt,ut),f(rt,at),f(rt,dt),T(dt,t[3][t[4]].s),f(Y,ft),f(Y,pt),f(pt,ht),f(pt,vt),f(pt,bt),T(bt,t[3][t[4]].l),f(W,yt),f(W,gt);for(let t=0;t<ae.length;t+=1)ae[t].m(gt,null);f(e,mt),f(e,wt),f(wt,xt),f(wt,kt),f(wt,qt);for(let t=0;t<be.length;t+=1)be[t].m(qt,null);f(e,zt),f(e,Mt),f(Mt,Tt),f(Mt,St),f(Mt,jt);for(let t=0;t<ge.length;t+=1)ge[t].m(jt,null);f(e,Rt),f(e,$t),me&&me.m($t,null),f($t,At),we&&we.m($t,null),f(e,It),f(e,Ot),f(Ot,Bt),f(Ot,Pt),f(Ot,_t),f(_t,Ct),f(Ct,Ut),f(Ut,Ft),f(Ct,Vt),f(Ct,Zt),f(Zt,Et),f(Ct,Jt),f(Ct,Kt),f(_t,Qt),ot(ce,_t,null),le=!0,re||(ue=[x(q,"change",t[22]),x(q,"input",t[22]),x(_,"change",t[23]),x(ct,"change",t[24]),x(ct,"input",t[24]),x(dt,"change",t[25]),x(dt,"input",t[25]),x(bt,"change",t[26]),x(bt,"input",t[26]),x(Ut,"click",t[15]),x(Zt,"click",t[16]),x(Kt,"click",t[17])],re=!0)},p(t,e){if((!le||2&e[0])&&M(u,t[1]),(!le||2&e[0])&&M(d,t[1]),2&e[0]&&T(q,t[1]),1&e[0]&&j(_,t[0]),t[6]?fe?fe.p(t,e):(fe=te(t),fe.c(),fe.m(P,null)):fe&&(fe.d(1),fe=null),24&e[0]&&T(ct,t[3][t[4]].h),(!le||128&e[0])&&S(dt,"--h",t[7].h),(!le||128&e[0])&&S(dt,"--l",t[7].l+"%"),24&e[0]&&T(dt,t[3][t[4]].s),(!le||128&e[0])&&S(bt,"--h",t[7].h),(!le||128&e[0])&&S(bt,"--s",t[7].s+"%"),24&e[0]&&T(bt,t[3][t[4]].l),16664&e[0]){const n=t[3];ae=X(ae,e,he,1,t,n,de,gt,Q,ee,null,Yt)}if(790528&e[0]){let n;for(ve=t[19],n=0;n<ve.length;n+=1){const o=Xt(t,ve,n);be[n]?be[n].p(o,e):(be[n]=ne(o),be[n].c(),be[n].m(qt,null))}for(;n<be.length;n+=1)be[n].d(1);be.length=ve.length}if(264192&e[0]){let n;for(ye=t[11],n=0;n<ye.length;n+=1){const o=Wt(t,ye,n);ge[n]?ge[n].p(o,e):(ge[n]=oe(o),ge[n].c(),ge[n].m(jt,null))}for(;n<ge.length;n+=1)ge[n].d(1);ge.length=ye.length}"selection"===t[12]?me?(me.p(t,e),4096&e[0]&&J(me,1)):(me=se(t),me.c(),J(me,1),me.m($t,At)):me&&(H(),K(me,1,1,(()=>{me=null})),D()),t[5]&&"brick"===t[0]?we?(we.p(t,e),33&e[0]&&J(we,1)):(we=ie(t),we.c(),J(we,1),we.m($t,null)):we&&(H(),K(we,1,1,(()=>{we=null})),D()),(!le||512&e[0]&&Nt!==(Nt=!t[9]))&&(Ut.disabled=Nt),(!le||512&e[0]&&Lt!==(Lt=t[9]?"undo":"undo (disabled)"))&&k(Ut,"aria-label",Lt),512&e[0]&&R(Ut,"disabled",!t[9]),(!le||1024&e[0]&&Gt!==(Gt=!t[10]))&&(Zt.disabled=Gt),(!le||1024&e[0]&&Dt!==(Dt=t[10]?"redo":"redo (disabled)"))&&k(Zt,"aria-label",Dt),1024&e[0]&&R(Zt,"disabled",!t[10])},i(t){le||(J(me),J(we),J(ce.$$.fragment,t),le=!0)},o(t){K(me),K(we),K(ce.$$.fragment,t),le=!1},d(t){t&&h(e),fe&&fe.d();for(let t=0;t<ae.length;t+=1)ae[t].d();v(be,t),v(ge,t),me&&me.d(),we&&we.d(),st(ce),re=!1,s(ue)}}}function le(t,e,n){let o,s,i,c,l,r,a;u(t,Bt,(t=>n(3,o=t))),u(t,gt,(t=>n(4,s=t))),u(t,mt,(t=>n(8,i=t))),u(t,_t,(t=>n(20,c=t))),u(t,Mt,(t=>n(21,l=t))),u(t,Rt,(t=>n(5,r=t))),u(t,Tt,(t=>n(12,a=t)));let{gridSize:d}=e,{stitchType:f="peyote"}=e,{layoutRotation:p=0}=e;const h=t=>{"grid"===t?Mt.toggle():"zoom-in"===t?kt.zoomIn():"zoom-out"===t?kt.zoomOut():"pan"===t?Tt.set("pan"):(Tt.set(t),"selection"!==t&&(St.clear(),jt.reset()))};let v,b,y,g,m;return t.$$set=t=>{"gridSize"in t&&n(1,d=t.gridSize),"stitchType"in t&&n(0,f=t.stitchType),"layoutRotation"in t&&n(2,p=t.layoutRotation)},t.$$.update=()=>{1&t.$$.dirty[0]&&n(6,v="square"===f),24&t.$$.dirty[0]&&n(7,b=o[s]),1048576&t.$$.dirty[0]&&n(9,y=c.canUndo||!1),1048576&t.$$.dirty[0]&&n(10,g=c.canRedo||!1),2097185&t.$$.dirty[0]&&n(11,m=[{id:"grid",icon:"🏁",label:"Grid",description:"Toggle grid visibility",color:"#6c757d",isToggle:!0,active:l},{id:"zoom-in",icon:"🔍",label:"Zoom In",description:"Zoom in on the canvas",color:"#17a2b8"},{id:"zoom-out",icon:"🔍",label:"Zoom Out",description:"Zoom out on the canvas",color:"#17a2b8"},..."brick"===f?[{id:"fringe",icon:"🧵",label:"Fringe",description:"Toggle fringe visibility for brick stitch",color:"#fd7e14",isToggle:!0,active:r}]:[]])},[f,d,p,o,s,r,v,b,i,y,g,m,a,()=>{n(2,p=(p+90)%360)},t=>()=>{i||gt.set(t)},()=>{const t=_t.undo();Ot.set(t)},()=>{const t=_t.redo();Ot.set(t)},()=>{kt.set(1),qt.set({x:0,y:0})},h,[{id:"paint",icon:"🖍️",label:"Paint",description:"Paint beads with selected color",color:"#007bff"},{id:"eraser",icon:"❌",label:"Eraser",description:"Erase colored beads",color:"#dc3545"},{id:"selection",icon:"🔲",label:"Select",description:"Select and move colored beads",color:"#28a745"},{id:"pan",icon:"✋",label:"Pan",description:"Pan and move around the canvas",color:"#6f42c1"}],c,l,function(){d=z(this.value),n(1,d)},function(){f=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.t}(this),n(0,f)},function(){o[s].h=z(this.value),Bt.set(o)},function(){o[s].s=z(this.value),Bt.set(o)},function(){o[s].l=z(this.value),Bt.set(o)},t=>h(t.id),t=>{"grid"===t.id?h("grid"):"fringe"===t.id?Rt.toggle():h(t.id)}]}class re extends ct{constructor(t){super(),it(this,t,le,ce,c,{gridSize:1,stitchType:0,layoutRotation:2},[-1,-1])}}function ue(t){let e,n;const o=t[1].default,s=function(t,e,n,o){if(t){const o=a(t,e,n,null);return t[0](o)}}(o,t,t[0]);return{c(){e=b("div"),s&&s.c(),k(e,"class","cell svelte-vsurxw")},m(t,o){p(t,e,o),s&&s.m(e,null),n=!0},p(t,[e]){s&&s.p&&1&e&&function(t,e,n,o,s,i,c){const l=function(t,e,n,o){if(t[2]&&o){const s=t[2](o(n));if(void 0===e.dirty)return s;if("object"==typeof s){const t=[],n=Math.max(e.dirty.length,s.length);for(let o=0;o<n;o+=1)t[o]=e.dirty[o]|s[o];return t}return e.dirty|s}return e.dirty}(e,o,s,i);if(l){const s=a(e,n,o,c);t.p(s,l)}}(s,o,t,t[0],e,null,null)},i(t){n||(J(s,t),n=!0)},o(t){K(s,t),n=!1},d(t){t&&h(e),s&&s.d(t)}}}function ae(t,e,n){let{$$slots:o={},$$scope:s}=e;return t.$$set=t=>{"$$scope"in t&&n(0,s=t.$$scope)},[s,o]}class de extends ct{constructor(t){super(),it(this,t,ae,ue,c,{})}}function fe(t){let n,o,i,c,l,r,u,a,d,f=[{id:t[0],x:t[1],y:t[2],width:t[3],height:t[4],fill:t[11]},{stroke:o=t[13]?"#9C27B0":t[15]?"black":"none"},{"stroke-width":i=t[13]?"0.3":"0.1"},{"stroke-dasharray":c=t[13]?"0.5,0.5":"none"},{opacity:l=t[6]?"0.6":"1"}],v={};for(let t=0;t<f.length;t+=1)v=e(v,f[t]);function b(t,e){return void 0!==t[10]&&t[12]&&t[16]?be:t[17]&&void 0!==t[9]&&"peyote"===t[7]&&!t[8]?ve:void 0}let g=b(t),k=g&&g(t);return{c(){n=y("rect"),r=m(),k&&k.c(),u=w(),q(n,v),R(n,"svelte-14fqjyl",!0)},m(e,o){p(e,n,o),p(e,r,o),k&&k.m(e,o),p(e,u,o),a||(d=[x(n,"click",t[18]),x(n,"mouseenter",t[19]),x(n,"touchstart",t[20]),x(n,"touchmove",t[21]),x(n,"touchend",t[22])],a=!0)},p(t,e){q(n,v=Y(f,[2079&e[0]&&{id:t[0],x:t[1],y:t[2],width:t[3],height:t[4],fill:t[11]},40960&e[0]&&o!==(o=t[13]?"#9C27B0":t[15]?"black":"none")&&{stroke:o},8192&e[0]&&i!==(i=t[13]?"0.3":"0.1")&&{"stroke-width":i},8192&e[0]&&c!==(c=t[13]?"0.5,0.5":"none")&&{"stroke-dasharray":c},64&e[0]&&l!==(l=t[6]?"0.6":"1")&&{opacity:l}])),R(n,"svelte-14fqjyl",!0),g===(g=b(t))&&k?k.p(t,e):(k&&k.d(1),k=g&&g(t),k&&(k.c(),k.m(u.parentNode,u)))},d(t){t&&h(n),t&&h(r),k&&k.d(t),t&&h(u),a=!1,s(d)}}}function pe(t){let e,n,o,i,c,l,r,u,a,d,f,v,b;function g(t,e){return void 0!==t[10]&&t[12]&&t[16]?ge:t[17]&&void 0!==t[9]&&"peyote"===t[7]&&!t[8]?ye:void 0}let q=g(t),z=q&&q(t);return{c(){e=y("circle"),d=m(),z&&z.c(),f=w(),k(e,"id",t[0]),k(e,"cx",n=t[1]+t[3]/2),k(e,"cy",o=t[2]+t[4]/2),k(e,"r",i=Math.min(t[3],t[4])/2),k(e,"fill",c=void 0!==t[10]?t[11]:"white"),k(e,"stroke",l=t[13]?"#9C27B0":t[15]?"black":"none"),k(e,"stroke-width",r=t[13]?"0.3":"0.1"),k(e,"stroke-dasharray",u=t[13]?"0.5,0.5":"none"),k(e,"opacity",a=t[6]?"0.6":"1"),k(e,"class","svelte-14fqjyl")},m(n,o){p(n,e,o),p(n,d,o),z&&z.m(n,o),p(n,f,o),v||(b=[x(e,"click",t[18]),x(e,"mouseenter",t[19]),x(e,"touchstart",t[20]),x(e,"touchmove",t[21]),x(e,"touchend",t[22])],v=!0)},p(t,s){1&s[0]&&k(e,"id",t[0]),10&s[0]&&n!==(n=t[1]+t[3]/2)&&k(e,"cx",n),20&s[0]&&o!==(o=t[2]+t[4]/2)&&k(e,"cy",o),24&s[0]&&i!==(i=Math.min(t[3],t[4])/2)&&k(e,"r",i),3072&s[0]&&c!==(c=void 0!==t[10]?t[11]:"white")&&k(e,"fill",c),40960&s[0]&&l!==(l=t[13]?"#9C27B0":t[15]?"black":"none")&&k(e,"stroke",l),8192&s[0]&&r!==(r=t[13]?"0.3":"0.1")&&k(e,"stroke-width",r),8192&s[0]&&u!==(u=t[13]?"0.5,0.5":"none")&&k(e,"stroke-dasharray",u),64&s[0]&&a!==(a=t[6]?"0.6":"1")&&k(e,"opacity",a),q===(q=g(t))&&z?z.p(t,s):(z&&z.d(1),z=q&&q(t),z&&(z.c(),z.m(f.parentNode,f)))},d(t){t&&h(e),t&&h(d),z&&z.d(t),t&&h(f),v=!1,s(b)}}}function he(t){let e,n,o,i,c,l,r,u,a,d,f,v,b;function g(t,e){return void 0!==t[10]&&t[12]&&t[16]?we:t[17]&&void 0!==t[9]&&"peyote"===t[7]&&!t[8]?me:void 0}let q=g(t),z=q&&q(t);return{c(){e=y("ellipse"),d=m(),z&&z.c(),f=w(),k(e,"id",t[0]),k(e,"cx",n=t[1]+t[3]/2),k(e,"cy",o=t[2]+t[4]/2),k(e,"rx",i=t[3]/2),k(e,"ry",c=t[4]/2),k(e,"fill","none"),k(e,"stroke",l=void 0!==t[10]?t[11]:t[15]?"black":"none"),k(e,"stroke-width",r=t[13]?"0.4":"0.2"),k(e,"stroke-dasharray",u=t[13]?"0.5,0.5":"none"),k(e,"opacity",a=t[6]?"0.6":"1"),k(e,"class","svelte-14fqjyl")},m(n,o){p(n,e,o),p(n,d,o),z&&z.m(n,o),p(n,f,o),v||(b=[x(e,"click",t[18]),x(e,"mouseenter",t[19]),x(e,"touchstart",t[20]),x(e,"touchmove",t[21]),x(e,"touchend",t[22])],v=!0)},p(t,s){1&s[0]&&k(e,"id",t[0]),10&s[0]&&n!==(n=t[1]+t[3]/2)&&k(e,"cx",n),20&s[0]&&o!==(o=t[2]+t[4]/2)&&k(e,"cy",o),8&s[0]&&i!==(i=t[3]/2)&&k(e,"rx",i),16&s[0]&&c!==(c=t[4]/2)&&k(e,"ry",c),35840&s[0]&&l!==(l=void 0!==t[10]?t[11]:t[15]?"black":"none")&&k(e,"stroke",l),8192&s[0]&&r!==(r=t[13]?"0.4":"0.2")&&k(e,"stroke-width",r),8192&s[0]&&u!==(u=t[13]?"0.5,0.5":"none")&&k(e,"stroke-dasharray",u),64&s[0]&&a!==(a=t[6]?"0.6":"1")&&k(e,"opacity",a),q===(q=g(t))&&z?z.p(t,s):(z&&z.d(1),z=q&&q(t),z&&(z.c(),z.m(f.parentNode,f)))},d(t){t&&h(e),t&&h(d),z&&z.d(t),t&&h(f),v=!1,s(b)}}}function ve(t){let e,n,o,s,i;return{c(){e=y("text"),n=g(t[9]),k(e,"x",o=t[1]+t[3]/2),k(e,"y",s=t[2]+t[4]/2+.1),k(e,"text-anchor","middle"),k(e,"dominant-baseline","middle"),k(e,"font-size",i=.6*Math.min(t[3],t[4])),k(e,"fill","black"),k(e,"font-weight","bold"),k(e,"pointer-events","none"),k(e,"class","svelte-14fqjyl")},m(t,o){p(t,e,o),f(e,n)},p(t,c){512&c[0]&&M(n,t[9]),10&c[0]&&o!==(o=t[1]+t[3]/2)&&k(e,"x",o),20&c[0]&&s!==(s=t[2]+t[4]/2+.1)&&k(e,"y",s),24&c[0]&&i!==(i=.6*Math.min(t[3],t[4]))&&k(e,"font-size",i)},d(t){t&&h(e)}}}function be(t){let e,n,o,s,i;return{c(){e=y("text"),n=g(t[12]),k(e,"x",o=t[1]+t[3]/2),k(e,"y",s=t[2]+t[4]/2+.1),k(e,"text-anchor","middle"),k(e,"dominant-baseline","middle"),k(e,"font-size",i=.7*Math.min(t[3],t[4])),k(e,"fill",t[14]),k(e,"font-weight","bold"),k(e,"pointer-events","none"),k(e,"class","svelte-14fqjyl")},m(t,o){p(t,e,o),f(e,n)},p(t,c){4096&c[0]&&M(n,t[12]),10&c[0]&&o!==(o=t[1]+t[3]/2)&&k(e,"x",o),20&c[0]&&s!==(s=t[2]+t[4]/2+.1)&&k(e,"y",s),24&c[0]&&i!==(i=.7*Math.min(t[3],t[4]))&&k(e,"font-size",i),16384&c[0]&&k(e,"fill",t[14])},d(t){t&&h(e)}}}function ye(t){let e,n,o,s,i;return{c(){e=y("text"),n=g(t[9]),k(e,"x",o=t[1]+t[3]/2),k(e,"y",s=t[2]+t[4]/2+.1),k(e,"text-anchor","middle"),k(e,"dominant-baseline","middle"),k(e,"font-size",i=.6*Math.min(t[3],t[4])),k(e,"fill","black"),k(e,"font-weight","bold"),k(e,"pointer-events","none"),k(e,"class","svelte-14fqjyl")},m(t,o){p(t,e,o),f(e,n)},p(t,c){512&c[0]&&M(n,t[9]),10&c[0]&&o!==(o=t[1]+t[3]/2)&&k(e,"x",o),20&c[0]&&s!==(s=t[2]+t[4]/2+.1)&&k(e,"y",s),24&c[0]&&i!==(i=.6*Math.min(t[3],t[4]))&&k(e,"font-size",i)},d(t){t&&h(e)}}}function ge(t){let e,n,o,s,i;return{c(){e=y("text"),n=g(t[12]),k(e,"x",o=t[1]+t[3]/2),k(e,"y",s=t[2]+t[4]/2+.1),k(e,"text-anchor","middle"),k(e,"dominant-baseline","middle"),k(e,"font-size",i=.7*Math.min(t[3],t[4])),k(e,"fill",t[14]),k(e,"font-weight","bold"),k(e,"pointer-events","none"),k(e,"class","svelte-14fqjyl")},m(t,o){p(t,e,o),f(e,n)},p(t,c){4096&c[0]&&M(n,t[12]),10&c[0]&&o!==(o=t[1]+t[3]/2)&&k(e,"x",o),20&c[0]&&s!==(s=t[2]+t[4]/2+.1)&&k(e,"y",s),24&c[0]&&i!==(i=.7*Math.min(t[3],t[4]))&&k(e,"font-size",i),16384&c[0]&&k(e,"fill",t[14])},d(t){t&&h(e)}}}function me(t){let e,n,o,s,i;return{c(){e=y("text"),n=g(t[9]),k(e,"x",o=t[1]+t[3]/2),k(e,"y",s=t[2]+t[4]/2+.1),k(e,"text-anchor","middle"),k(e,"dominant-baseline","middle"),k(e,"font-size",i=.6*Math.min(t[3],t[4])),k(e,"fill","black"),k(e,"font-weight","bold"),k(e,"pointer-events","none"),k(e,"class","svelte-14fqjyl")},m(t,o){p(t,e,o),f(e,n)},p(t,c){512&c[0]&&M(n,t[9]),10&c[0]&&o!==(o=t[1]+t[3]/2)&&k(e,"x",o),20&c[0]&&s!==(s=t[2]+t[4]/2+.1)&&k(e,"y",s),24&c[0]&&i!==(i=.6*Math.min(t[3],t[4]))&&k(e,"font-size",i)},d(t){t&&h(e)}}}function we(t){let e,n,o,s,i;return{c(){e=y("text"),n=g(t[12]),k(e,"x",o=t[1]+t[3]/2),k(e,"y",s=t[2]+t[4]/2+.1),k(e,"text-anchor","middle"),k(e,"dominant-baseline","middle"),k(e,"font-size",i=.7*Math.min(t[3],t[4])),k(e,"fill",t[14]),k(e,"font-weight","bold"),k(e,"pointer-events","none"),k(e,"class","svelte-14fqjyl")},m(t,o){p(t,e,o),f(e,n)},p(t,c){4096&c[0]&&M(n,t[12]),10&c[0]&&o!==(o=t[1]+t[3]/2)&&k(e,"x",o),20&c[0]&&s!==(s=t[2]+t[4]/2+.1)&&k(e,"y",s),24&c[0]&&i!==(i=.7*Math.min(t[3],t[4]))&&k(e,"font-size",i),16384&c[0]&&k(e,"fill",t[14])},d(t){t&&h(e)}}}function xe(e){let n;function o(t,e){return"oval-ring"===t[5]?he:"circle"===t[5]?pe:fe}let s=o(e),i=s(e);return{c(){i.c(),n=w()},m(t,e){i.m(t,e),p(t,n,e)},p(t,e){s===(s=o(t))&&i?i.p(t,e):(i.d(1),i=s(t),i&&(i.c(),i.m(n.parentNode,n)))},i:t,o:t,d(t){i.d(t),t&&h(n)}}}function ke(t,e,n){let o,s,i,c,l,r,a,d,f,p,h;u(t,At,(t=>n(25,o=t))),u(t,Ot,(t=>n(26,s=t))),u(t,Bt,(t=>n(28,i=t))),u(t,St,(t=>n(29,c=t))),u(t,Tt,(t=>n(31,l=t))),u(t,gt,(t=>n(32,r=t))),u(t,Pt,(t=>n(33,a=t))),u(t,zt,(t=>n(34,d=t))),u(t,Mt,(t=>n(15,f=t))),u(t,wt,(t=>n(16,p=t))),u(t,xt,(t=>n(17,h=t)));let{id:v}=e,{x:b}=e,{y:y}=e,{width:g}=e,{height:m}=e,{shape:w="rectangle"}=e,{isPreview:x=!1}=e,{stitchType:k="peyote"}=e,{isFringe:q=!1}=e,{isTouchActive:z=!1}=e,{rowNumber:M}=e;const T=()=>{const t=l;q?"eraser"===t?At.update((t=>{const e={...t};return delete e[S],e})):"paint"===t&&At.update((t=>({...t,[S]:r}))):"eraser"===t?Ot.update((t=>{const e={...t};return delete e[S],e})):"paint"===t&&Ot.update((t=>({...t,[S]:r})))};let S,j,R,$,A,I,O,B;return t.$$set=t=>{"id"in t&&n(0,v=t.id),"x"in t&&n(1,b=t.x),"y"in t&&n(2,y=t.y),"width"in t&&n(3,g=t.width),"height"in t&&n(4,m=t.height),"shape"in t&&n(5,w=t.shape),"isPreview"in t&&n(6,x=t.isPreview),"stitchType"in t&&n(7,k=t.stitchType),"isFringe"in t&&n(8,q=t.isFringe),"isTouchActive"in t&&n(23,z=t.isTouchActive),"rowNumber"in t&&n(9,M=t.rowNumber)},t.$$.update=()=>{65&t.$$.dirty[0]&&n(24,S=x?v.replace("preview_",""):v),117440768&t.$$.dirty[0]&&n(10,j=q?o[S]:s[S]),268436480&t.$$.dirty[0]&&n(27,R=void 0!==j?i[j]:{h:0,s:100,l:100}),134217728&t.$$.dirty[0]&&n(11,$=`hsl(${R.h}, ${R.s}%, ${R.l}%)`),134217728&t.$$.dirty[0]&&n(12,A=R.symbol||""),553648128&t.$$.dirty[0]&&n(13,I=c.has(S)),1024&t.$$.dirty[0]&&(O=void 0!==j),134218752&t.$$.dirty[0]&&n(14,B=(()=>{if(void 0===j)return"black";const t=R.h/360,e=R.s/100,n=R.l/100,o=(t,e,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t);let s,i,c;if(0===e)s=i=c=n;else{const l=n<.5?n*(1+e):n+e-n*e,r=2*n-l;s=o(r,l,t+1/3),i=o(r,l,t),c=o(r,l,t-1/3)}return.299*s+.587*i+.114*c<.5?"white":"black"})())},[v,b,y,g,m,w,x,k,q,M,j,$,A,I,B,f,p,h,()=>{if("painting"!==a||x||d)return;const t=l;"selection"===t?O&&(I?St.remove(S):St.add(S)):"paint"!==t&&"eraser"!==t||(T(),_t.commit(s))},t=>{if("painting"!==a||x||d)return;const e=l;"selection"===e?1===t.buttons&&O&&(I||St.add(S)):"paint"!==e&&"eraser"!==e||1===t.buttons&&T()},t=>{"painting"!==a||x||"paint"!==l&&"eraser"!==l||(t.preventDefault(),T())},t=>{"painting"!==a||x||"paint"!==l&&"eraser"!==l||!z||(t.preventDefault(),T())},t=>{},z,S,o,s,R,i,c]}class qe extends ct{constructor(t){super(),it(this,t,ke,xe,c,{id:0,x:1,y:2,width:3,height:4,shape:5,isPreview:6,stitchType:7,isFringe:8,isTouchActive:23,rowNumber:9},[-1,-1])}}function ze(t,e,n,o=0){const s=Math.floor(n/2)-1;if(e===s)return o;const i=Math.abs(e-s);let c;return c=t%2==0?1===i?1:2===i?3:[5,7,9,1,3,5,7,9,1,3][(i-3)%10]:1===i?2:2===i?4:[6,8,0,2,4,6,8,0,2,4][(i-3)%10],c+o}const Me=t=>[...Array(t).keys()],Te=1.64;function Se(t,e,n){const o=t.slice();return o[49]=e[n],o}function je(t,e,n){const o=t.slice();return o[52]=e[n],o}function Re(t,e,n){const o=t.slice();return o[55]=e[n],o}function $e(t,n){let o,s,i;const c=[n[55],{stitchType:n[1]},{isTouchActive:n[0]}];let l={};for(let t=0;t<c.length;t+=1)l=e(l,c[t]);return s=new qe({props:l}),{key:t,first:null,c(){o=w(),nt(s.$$.fragment),this.first=o},m(t,e){p(t,o,e),ot(s,t,e),i=!0},p(t,e){const n=7&e[0]?Y(c,[4&e[0]&&tt(t[55]),2&e[0]&&{stitchType:t[1]},1&e[0]&&{isTouchActive:t[0]}]):{};s.$set(n)},i(t){i||(J(s.$$.fragment,t),i=!0)},o(t){K(s.$$.fragment,t),i=!1},d(t){t&&h(o),st(s,t)}}}function Ae(t,n){let o,s,i;const c=[n[52],{stitchType:n[1]},{isTouchActive:n[0]}];let l={};for(let t=0;t<c.length;t+=1)l=e(l,c[t]);return s=new qe({props:l}),{key:t,first:null,c(){o=w(),nt(s.$$.fragment),this.first=o},m(t,e){p(t,o,e),ot(s,t,e),i=!0},p(t,e){const n=131&e[0]?Y(c,[128&e[0]&&tt(t[52]),2&e[0]&&{stitchType:t[1]},1&e[0]&&{isTouchActive:t[0]}]):{};s.$set(n)},i(t){i||(J(s.$$.fragment,t),i=!0)},o(t){K(s.$$.fragment,t),i=!1},d(t){t&&h(o),st(s,t)}}}function Ie(t,n){let o,s,i;const c=[n[49],{isPreview:!0},{stitchType:n[1]},{isTouchActive:n[0]}];let l={};for(let t=0;t<c.length;t+=1)l=e(l,c[t]);return s=new qe({props:l}),{key:t,first:null,c(){o=w(),nt(s.$$.fragment),this.first=o},m(t,e){p(t,o,e),ot(s,t,e),i=!0},p(t,e){const n=259&e[0]?Y(c,[256&e[0]&&tt(t[49]),c[1],2&e[0]&&{stitchType:t[1]},1&e[0]&&{isTouchActive:t[0]}]):{};s.$set(n)},i(t){i||(J(s.$$.fragment,t),i=!0)},o(t){K(s.$$.fragment,t),i=!1},d(t){t&&h(o),st(s,t)}}}function Oe(t){let e,n,o,i,c,l,r,u=[],a=new Map,d=[],v=new Map,b=[],g=new Map,m=t[2];const q=t=>t[55].id;for(let e=0;e<m.length;e+=1){let n=Re(t,m,e),o=q(n);a.set(o,u[e]=$e(o,n))}let z=t[7];const M=t=>t[52].id;for(let e=0;e<z.length;e+=1){let n=je(t,z,e),o=M(n);v.set(o,d[e]=Ae(o,n))}let T=t[8];const S=t=>t[49].id;for(let e=0;e<T.length;e+=1){let n=Se(t,T,e),o=S(n);g.set(o,b[e]=Ie(o,n))}return{c(){e=y("svg"),n=y("g");for(let t=0;t<u.length;t+=1)u[t].c();o=w();for(let t=0;t<d.length;t+=1)d[t].c();i=w();for(let t=0;t<b.length;t+=1)b[t].c();k(n,"transform",t[9]),k(e,"viewBox",t[6]),k(e,"class","svelte-buvcpq"),R(e,"pan-mode",t[5])},m(s,a){p(s,e,a),f(e,n);for(let t=0;t<u.length;t+=1)u[t].m(n,null);f(n,o);for(let t=0;t<d.length;t+=1)d[t].m(n,null);f(n,i);for(let t=0;t<b.length;t+=1)b[t].m(n,null);t[35](e),c=!0,l||(r=[x(e,"touchstart",t[10]),x(e,"touchmove",t[11]),x(e,"touchend",t[12]),x(e,"pointerup",t[36]),x(e,"wheel",t[13]),x(e,"mousedown",t[14]),x(e,"mousemove",t[15]),x(e,"mouseup",t[16]),x(e,"mouseleave",t[17]),x(e,"contextmenu",Be)],l=!0)},p(t,s){if(7&s[0]){const e=t[2];H(),u=X(u,s,q,1,t,e,a,n,W,$e,o,Re),D()}if(131&s[0]){const e=t[7];H(),d=X(d,s,M,1,t,e,v,n,W,Ae,i,je),D()}if(259&s[0]){const e=t[8];H(),b=X(b,s,S,1,t,e,g,n,W,Ie,null,Se),D()}(!c||512&s[0])&&k(n,"transform",t[9]),(!c||64&s[0])&&k(e,"viewBox",t[6]),32&s[0]&&R(e,"pan-mode",t[5])},i(t){if(!c){for(let t=0;t<m.length;t+=1)J(u[t]);for(let t=0;t<z.length;t+=1)J(d[t]);for(let t=0;t<T.length;t+=1)J(b[t]);c=!0}},o(t){for(let t=0;t<u.length;t+=1)K(u[t]);for(let t=0;t<d.length;t+=1)K(d[t]);for(let t=0;t<b.length;t+=1)K(b[t]);c=!1},d(n){n&&h(e);for(let t=0;t<u.length;t+=1)u[t].d();for(let t=0;t<d.length;t+=1)d[t].d();for(let t=0;t<b.length;t+=1)b[t].d();t[35](null),l=!1,s(r)}}}const Be=t=>t.preventDefault();function Pe(t,e,n){let o,s,i,c,l,r,a,f,p,h,v,b;u(t,Tt,(t=>n(21,o=t))),u(t,$t,(t=>n(24,s=t))),u(t,It,(t=>n(29,i=t))),u(t,Rt,(t=>n(30,c=t))),u(t,St,(t=>n(31,l=t))),u(t,jt,(t=>n(32,r=t))),u(t,Ot,(t=>n(3,a=t))),u(t,qt,(t=>n(33,f=t))),u(t,kt,(t=>n(34,p=t))),u(t,gt,(t=>n(46,h=t))),u(t,Pt,(t=>n(47,v=t))),u(t,zt,(t=>n(48,b=t)));let y,g,m,w,x,k,q,z,M,T,S,j,R,{gridSize:$}=e,{layoutRotation:A}=e,{stitchType:I="peyote"}=e,B={x:0,y:0},P=!1,_=0,C={x:0,y:0},U={x:0,y:0},F=null,{isTouchActive:N=!1}=e;return t.$$set=t=>{"gridSize"in t&&n(18,$=t.gridSize),"layoutRotation"in t&&n(19,A=t.layoutRotation),"stitchType"in t&&n(1,I=t.stitchType),"isTouchActive"in t&&n(0,N=t.isTouchActive)},t.$$.update=()=>{2097152&t.$$.dirty[0]&&n(5,g="pan"===o),262144&t.$$.dirty[0]&&n(22,m=2*($+1)),262144&t.$$.dirty[0]&&n(23,w=2*($+2)),t.$$.dirty[0],262144&t.$$.dirty[0]&&n(25,x=$*Te+6),262144&t.$$.dirty[0]&&n(26,k=2*$+6),37748736&t.$$.dirty[0]&&n(27,q=Math.max(x,m)),75497472&t.$$.dirty[0]&&n(28,z=Math.max(k,w)),402653184&t.$$.dirty[0]&&n(6,M=`0 0 ${q} ${z}`),550240258&t.$$.dirty[0]&&n(2,T=function(t,e,n,o,s,i,c,l=0){switch(c){case"square":return function(t,e,n,o,s,i){const c=t*n,l=t*e;let r,u;90===i||270===i?(r=(s-c)/2,u=(o-l)/2):(r=(s-l)/2,u=(o-c)/2);const a=[];for(let o=0;o<t;o++)for(let s=0;s<t;s++)90===i||270===i?a.push({id:o*t+s,x:r+n*s,y:u+e*o,height:e,width:n}):a.push({id:o*t+s,x:r+e*o,y:u+n*s,height:n,width:e});return a}(t,e,n,o,s,i);case"peyote":return function(t,e,n,o,s,i,c=0){return 180===i?Me(t).flatMap((i=>Me(t).flatMap((l=>{const r={id:i*t+l,x:s-n*(i+1.5)-6,y:o-(i%2?e*(l+1):e*(l+1.5))+1,height:e,width:n};return r.rowNumber=ze(i,l,t,c),r})))):Me(t).flatMap((o=>Me(t).flatMap((s=>{const i={id:o*t+s,x:n*(o+1.5)+2,y:o%2?e*(s+1):e*(s+1.5),height:e,width:n};return i.rowNumber=ze(o,s,t,c),i}))))}(t,e,n,o,s,i,l);case"brick":return function(t,e,n,o,s,i){return 90===i?Me(t).flatMap((s=>Me(t).flatMap((i=>({id:s*t+i,x:o-(s%2?e*(i+1):e*(i+1.5)),y:n*(s+1.5)+3,height:n,width:e}))))):Me(t).flatMap((o=>Me(t).flatMap((i=>({id:o*t+i,x:o%2?e*(i+1):e*(i+1.5)-2,y:s-(n*(o+1.5)+3)-2,height:n,width:e})))))}(t,e,n,o,s,i);default:return function(t,e,n,o,s,i){switch(i){case 90:return Me(t).flatMap((s=>Me(t).flatMap((i=>({id:s*t+i,x:o-(s%2?e*(i+1):e*(i+1.5)),y:n*(s+1.5)+3,height:n,width:e})))));case 180:return Me(t).flatMap((i=>Me(t).flatMap((c=>({id:i*t+c,x:s-n*(i+1.5)-6,y:o-(i%2?e*(c+1):e*(c+1.5))+1,height:e,width:n})))));case 270:return Me(t).flatMap((o=>Me(t).flatMap((i=>({id:o*t+i,x:o%2?e*(i+1):e*(i+1.5)-2,y:s-(n*(o+1.5)+3)-2,height:e,width:n})))));default:return Me(t).flatMap((o=>Me(t).flatMap((s=>({id:o*t+s,x:n*(o+1.5)+2,y:o%2?e*(s+1):e*(s+1.5),height:e,width:n})))))}}(t,e,n,o,s,i)}}($,2,Te,m,w,A,I,i)),1091305478&t.$$.dirty[0]&&n(7,S=c&&"brick"===I?function(t,e,n,o,s,i,c){if(!t||e<=0)return[];const l=[];let r=1e4;return function(t){const e=(t-1)*t;return Array.from({length:t},((t,n)=>e+n))}(o).forEach((t=>{const o=n.find((e=>e.id==t));if(!o)return;const c=o.x+o.width/2,u=o.y+o.height;for(let n=0;n<e;n++)l.push({id:"fringe_"+r++,x:c-i/2,y:u+n*i,width:i,height:s,isFringe:!0,parentBeadId:t,fringeIndex:n})})),l}(c,s,T,$,2,Te):[]),786446&t.$$.dirty[0]|3&t.$$.dirty[1]&&n(8,j=function(t,e,n,o,s,i,c){if(0===t.size||0===e.x&&0===e.y)return[];const l=[];return Array.from(t).forEach((t=>{if(n.find((e=>e.id===t))&&void 0!==o[t]){const o=Ut(t,0,i),s=Ft(o.row+e.y,o.col+e.x,i);if(null!==s){const e=n.find((t=>t.id===s));if(e){const n={...e,id:`preview_${t}`};l.push(n)}}}})),l}(l,r,T,a,0,$)),12&t.$$.dirty[1]&&n(9,R=`translate(${f.x}, ${f.y}) scale(${p})`)},[N,I,T,a,y,g,M,S,j,R,t=>{if(1===t.touches.length)if(g){const e=t.touches[0];U={x:e.clientX,y:e.clientY},B={x:e.clientX,y:e.clientY},P=!0,t.preventDefault()}else{n(0,N=!0);const e=t.touches[0],s=document.elementFromPoint(e.clientX,e.clientY);if(s&&s.id&&"ellipse"===s.tagName||"circle"===s.tagName||"rect"===s.tagName){const t=s.id,e=o;if("paint"===e){const e=T.find((e=>e.id===t))||S.find((e=>e.id===t));e&&e.isFringe?At.update((e=>({...e,[t]:h}))):d(Ot,a[t]=h,a)}else if("eraser"===e){const e=T.find((e=>e.id===t))||S.find((e=>e.id===t));e&&e.isFringe?At.update((e=>{const n={...e};return delete n[t],n})):Ot.update((e=>{const n={...e};return delete n[t],n}))}F=t}}else if(2===t.touches.length)if(t.preventDefault(),g){P=!0;const e=t.touches[0],n=t.touches[1];B={x:(e.clientX+n.clientX)/2,y:(e.clientY+n.clientY)/2}}else{const e=t.touches[0],n=t.touches[1];_=Math.sqrt(Math.pow(n.clientX-e.clientX,2)+Math.pow(n.clientY-e.clientY,2)),C={x:(e.clientX+n.clientX)/2,y:(e.clientY+n.clientY)/2},P=!1}},t=>{if(1===t.touches.length){if(g&&P){const e=t.touches[0],n=e.clientX-B.x,o=e.clientY-B.y;t.preventDefault();const s=.25;qt.update((t=>({x:t.x+n*s,y:t.y+o*s}))),B={x:e.clientX,y:e.clientY}}else if(!g&&N&&"painting"===v){const e=t.touches[0],n=document.elementFromPoint(e.clientX,e.clientY);if(n&&n.id&&("ellipse"===n.tagName||"circle"===n.tagName||"rect"===n.tagName)&&n.id!==F){const t=n.id,e=o;if("paint"===e){const e=T.find((e=>e.id===t))||S.find((e=>e.id===t));e&&e.isFringe?At.update((e=>({...e,[t]:h}))):d(Ot,a[t]=h,a)}else if("eraser"===e){const e=T.find((e=>e.id===t))||S.find((e=>e.id===t));e&&e.isFringe?At.update((e=>{const n={...e};return delete n[t],n})):Ot.update((e=>{const n={...e};return delete n[t],n}))}F=t}}}else if(2===t.touches.length){t.preventDefault();const e=t.touches[0],n=t.touches[1];if(g){const t=(e.clientX+n.clientX)/2,o=(e.clientY+n.clientY)/2,s=t-B.x,i=o-B.y,c=.25;qt.update((t=>({x:t.x+s*c,y:t.y+i*c}))),B={x:t,y:o}}else{const t=Math.sqrt(Math.pow(n.clientX-e.clientX,2)+Math.pow(n.clientY-e.clientY,2));if(_>0){const o=t/_,s=Math.max(.2,Math.min(5,p*o));if(s!==p){const t=y.getBoundingClientRect(),o=(e.clientX+n.clientX)/2-t.left,i=(e.clientY+n.clientY)/2-t.top,c=y.createSVGPoint();c.x=o,c.y=i;const l=y.getScreenCTM().inverse(),r=c.matrixTransform(l),u=p,a=(r.x-f.x)/u,d=(r.y-f.y)/u;kt.set(s);const h=r.x-a*s,v=r.y-d*s;qt.set({x:h,y:v})}}_=t}}},t=>{if(0===t.touches.length)g&&(P=!1,_=0,F=null),n(0,N=!1);else if(1===t.touches.length&&g){const e=t.touches[0];U={x:e.clientX,y:e.clientY},B={x:e.clientX,y:e.clientY},F=null,P=!0}},t=>{t.preventDefault();const e=y.getBoundingClientRect(),n=t.clientX-e.left,o=t.clientY-e.top,s=y.createSVGPoint();s.x=n,s.y=o;const i=y.getScreenCTM().inverse(),c=s.matrixTransform(i),l=p,r=t.deltaY<0?1.2:1/1.2,u=Math.max(.2,Math.min(5,l*r));if(u!==l){const t=(c.x-f.x)/l,e=(c.y-f.y)/l;kt.set(u);const n=c.x-t*u,o=c.y-e*u;qt.set({x:n,y:o})}},t=>{1!==t.button&&2!==t.button||(t.preventDefault(),t.stopPropagation(),zt.set(!0),B={x:t.clientX,y:t.clientY},n(4,y.style.cursor="grabbing",y))},t=>{if(b){t.preventDefault(),t.stopPropagation();const e=t.clientX-B.x,n=t.clientY-B.y,o=.3;qt.update((t=>({x:t.x+e*o,y:t.y+n*o}))),B={x:t.clientX,y:t.clientY}}},t=>{b&&(t.preventDefault(),t.stopPropagation(),zt.set(!1),n(4,y.style.cursor="grab",y))},()=>{b&&(zt.set(!1),n(4,y.style.cursor="grab",y))},$,A,()=>{kt.set(1),qt.set({x:0,y:0})},o,m,w,s,x,k,q,z,i,c,l,r,f,p,function(t){O[t?"unshift":"push"]((()=>{y=t,n(4,y)}))},()=>_t.commit(a)]}class _e extends ct{constructor(t){super(),it(this,t,Pe,Oe,c,{gridSize:18,layoutRotation:19,stitchType:1,isTouchActive:0,resetView:20},[-1,-1])}get resetView(){return this.$$.ctx[20]}}function Ce(t,e,n){const o=t.slice();return o[3]=e[n],o}function Ue(t){let e,n,o,s=[],i=new Map,c=t[1];const l=t=>t[3].id;for(let e=0;e<c.length;e+=1){let n=Ce(t,c,e),o=l(n);i.set(o,s[e]=Fe(o,n))}let r=0===t[1].length&&Ne();return{c(){e=b("div");for(let t=0;t<s.length;t+=1)s[t].c();n=m(),r&&r.c(),o=w(),k(e,"class","legend-items svelte-krzqo6")},m(t,i){p(t,e,i);for(let t=0;t<s.length;t+=1)s[t].m(e,null);p(t,n,i),r&&r.m(t,i),p(t,o,i)},p(t,n){if(2&n){const o=t[1];s=X(s,n,l,1,t,o,i,e,Q,Fe,null,Ce)}0===t[1].length?r||(r=Ne(),r.c(),r.m(o.parentNode,o)):r&&(r.d(1),r=null)},d(t){t&&h(e);for(let t=0;t<s.length;t+=1)s[t].d();t&&h(n),r&&r.d(t),t&&h(o)}}}function Fe(t,e){let n,o,s,i,c,l,r,u,a,d=e[3].symbol+"",v=e[3].count+"";return{key:t,first:null,c(){n=b("div"),o=b("div"),s=m(),i=b("span"),c=g(d),l=m(),r=b("span"),u=g(v),a=m(),k(o,"class","color-swatch svelte-krzqo6"),S(o,"background-color","hsl("+e[3].color.h+", "+e[3].color.s+"%, "+e[3].color.l+"%)"),k(i,"class","symbol svelte-krzqo6"),k(r,"class","count svelte-krzqo6"),k(n,"class","legend-item svelte-krzqo6"),this.first=n},m(t,e){p(t,n,e),f(n,o),f(n,s),f(n,i),f(i,c),f(n,l),f(n,r),f(r,u),f(n,a)},p(t,e){2&e&&S(o,"background-color","hsl("+t[3].color.h+", "+t[3].color.s+"%, "+t[3].color.l+"%)"),2&e&&d!==(d=t[3].symbol+"")&&M(c,d),2&e&&v!==(v=t[3].count+"")&&M(u,v)},d(t){t&&h(n)}}}function Ne(t){let e;return{c(){e=b("p"),e.textContent="No colors used yet",k(e,"class","no-colors svelte-krzqo6")},m(t,n){p(t,e,n)},d(t){t&&h(e)}}}function Le(e){let n,o,s,i,c,l,r,u,a,d=e[0]?"−":"+",v=e[0]&&Ue(e);return{c(){n=b("div"),o=b("div"),s=b("h3"),s.textContent="Bead Legend",i=m(),c=b("button"),l=g(d),r=m(),v&&v.c(),k(s,"class","svelte-krzqo6"),k(c,"class","toggle-button svelte-krzqo6"),k(c,"aria-label","Toggle legend visibility"),k(o,"class","legend-header svelte-krzqo6"),k(n,"class","color-legend svelte-krzqo6")},m(t,d){p(t,n,d),f(n,o),f(o,s),f(o,i),f(o,c),f(c,l),f(n,r),v&&v.m(n,null),u||(a=x(c,"click",e[2]),u=!0)},p(t,[e]){1&e&&d!==(d=t[0]?"−":"+")&&M(l,d),t[0]?v?v.p(t,e):(v=Ue(t),v.c(),v.m(n,null)):v&&(v.d(1),v=null)},i:t,o:t,d(t){t&&h(n),v&&v.d(),u=!1,a()}}}function Ve(t,e,n){let o,s;return u(t,wt,(t=>n(0,o=t))),u(t,Ct,(t=>n(1,s=t))),[o,s,()=>{o?wt.set(!1):(xt.set(!1),wt.set(!0))}]}class Ze extends ct{constructor(t){super(),it(this,t,Ve,Le,c,{})}}function Ee(e){let n,o,s,i,c,l,r,u,a=e[0]?"−":"+";return{c(){n=b("div"),o=b("div"),s=b("h3"),s.textContent="Row Numbers",i=m(),c=b("button"),l=g(a),k(s,"class","svelte-1gzlzfj"),k(c,"class","toggle-button svelte-1gzlzfj"),k(c,"aria-label","Toggle row numbers visibility"),k(o,"class","row-numbers-header svelte-1gzlzfj"),k(n,"class","row-numbers svelte-1gzlzfj")},m(t,a){p(t,n,a),f(n,o),f(o,s),f(o,i),f(o,c),f(c,l),r||(u=x(c,"click",e[1]),r=!0)},p(t,[e]){1&e&&a!==(a=t[0]?"−":"+")&&M(l,a)},i:t,o:t,d(t){t&&h(n),r=!1,u()}}}function Ge(t,e,n){let o;return u(t,xt,(t=>n(0,o=t))),[o,()=>{o?xt.set(!1):(wt.set(!1),xt.set(!0))}]}class He extends ct{constructor(t){super(),it(this,t,Ge,Ee,c,{})}}function De(t){let n,o,s,i,c,l,r,u,a,d,v,y,g;const w=[{gridSize:t[0],layoutRotation:t[1],stitchType:t[2]}];let x={};for(let t=0;t<w.length;t+=1)x=e(x,w[t]);function q(e){t[3].call(null,e)}function z(e){t[4].call(null,e)}function M(e){t[5].call(null,e)}o=new _e({props:x});let T={};return void 0!==t[0]&&(T.gridSize=t[0]),void 0!==t[2]&&(T.stitchType=t[2]),void 0!==t[1]&&(T.layoutRotation=t[1]),i=new re({props:T}),O.push((()=>et(i,"gridSize",q))),O.push((()=>et(i,"stitchType",z))),O.push((()=>et(i,"layoutRotation",M))),d=new Ze({}),y=new He({}),{c(){n=b("div"),nt(o.$$.fragment),s=m(),nt(i.$$.fragment),u=m(),a=b("div"),nt(d.$$.fragment),v=m(),nt(y.$$.fragment),k(n,"class","canvas-area svelte-6x3nav"),k(a,"class","legend-area svelte-6x3nav")},m(t,e){p(t,n,e),ot(o,n,null),f(n,s),ot(i,n,null),p(t,u,e),p(t,a,e),ot(d,a,null),f(a,v),ot(y,a,null),g=!0},p(t,e){const n=7&e?Y(w,[{gridSize:t[0],layoutRotation:t[1],stitchType:t[2]}]):{};o.$set(n);const s={};!c&&1&e&&(c=!0,s.gridSize=t[0],F((()=>c=!1))),!l&&4&e&&(l=!0,s.stitchType=t[2],F((()=>l=!1))),!r&&2&e&&(r=!0,s.layoutRotation=t[1],F((()=>r=!1))),i.$set(s)},i(t){g||(J(o.$$.fragment,t),J(i.$$.fragment,t),J(d.$$.fragment,t),J(y.$$.fragment,t),g=!0)},o(t){K(o.$$.fragment,t),K(i.$$.fragment,t),K(d.$$.fragment,t),K(y.$$.fragment,t),g=!1},d(t){t&&h(n),st(o),st(i),t&&h(u),t&&h(a),st(d),st(y)}}}function Je(t){let e,n,o,s,i;return n=new rt({}),s=new de({props:{$$slots:{default:[De]},$$scope:{ctx:t}}}),{c(){e=b("main"),nt(n.$$.fragment),o=m(),nt(s.$$.fragment),k(e,"class","painting svelte-6x3nav")},m(t,c){p(t,e,c),ot(n,e,null),f(e,o),ot(s,e,null),i=!0},p(t,[e]){const n={};135&e&&(n.$$scope={dirty:e,ctx:t}),s.$set(n)},i(t){i||(J(n.$$.fragment,t),J(s.$$.fragment,t),i=!0)},o(t){K(n.$$.fragment,t),K(s.$$.fragment,t),i=!1},d(t){t&&h(e),st(n),st(s)}}}function Ke(t,e,n){let o=20,s=90,i="peyote";return[o,s,i,function(t){o=t,n(0,o)},function(t){i=t,n(2,i)},function(t){s=t,n(1,s)}]}class Qe extends ct{constructor(t){super(),it(this,t,Ke,Je,c,{})}}const We=new Map;"undefined"!=typeof document&&document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".beads-pattern-designer-container").forEach((t=>{t.id&&We.has(t.id)}))}));const Xe={init:function(t){const e=document.getElementById(t);if(!e)return;if(We.has(t))return;const n=parseInt(e.dataset.gridSize)||20,o=e.dataset.stitchType||"peyote",s=parseInt(e.dataset.layoutRotation)||90,i=new Qe({target:e,props:{gridSize:n,stitchType:o,layoutRotation:s}});return We.set(t,i),i},destroy:function(t){const e=We.get(t);e&&(e.$destroy(),We.delete(t))},destroyAll:function(){We.forEach((t=>t.$destroy())),We.clear()},instances:We};return"undefined"!=typeof window&&(window.BeadApp=Xe),Xe}();
